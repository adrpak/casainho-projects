#summary Digital bathroom scale which logs weight and data on SD Card
#labels Featured

= Introduction =

On this project I hacked a digital bathroom scale, for write (log) my weight variations over time, on a memory SD Card. I write the information on a comma separated values (CSV) file (weight.csv) so I can build a graph using OpenOffice.

*[http://blip.tv/file/get/Jpcasainho-SDCardBathroomScale20090814820.ogg See this video]* that shows the scale working. Here is a picture of a graph made using the data written on "weight.csv" file:

[http://casainho-projects.googlecode.com/svn-history/r65/trunk/sdcard_bathroom_scale/images/weight_vs_time_graph-20090814.jpg]

Source code plus pictures of current work can be found on [http://code.google.com/p/casainho-projects/source/browse/trunk/sdcard_bathroom_scale/ SVN].

= Details =
== The original scale ==
http://casainho-projects.googlecode.com/svn/trunk/sdcard_bathroom_scale/images/sdcard_bathroom_scale-20090703-01.jpg

== The prototype ==
===LCD module added to the scale===
http://casainho-projects.googlecode.com/svn/trunk/sdcard_bathroom_scale/images/sdcard_bathroom_scale-20090703-08.jpg

===Picture taken on 20090724, showing the SD Card added to the protype===
http://casainho-projects.googlecode.com/svn/trunk/sdcard_bathroom_scale/images/sdcard_bathroom_scale-20090724-800x-02.jpg

== Digital Scale LCD signals ==
The next 2 pictures shows a backplane signal and 2 segments signals.

http://casainho-projects.googlecode.com/svn/trunk/sdcard_bathroom_scale/images/osci_image-20090605-10.jpg

http://casainho-projects.googlecode.com/svn/trunk/sdcard_bathroom_scale/images/osci_image-20090605-11.jpg

The next picture shows a backplane signal and a digital signal used to sync system to the signals. I got that sync signal using an LM258 opamp working as a comparator, like a signal value detector.

http://casainho-projects.googlecode.com/svn/trunk/sdcard_bathroom_scale/images/osci_image-20090615-01.jpg

== Pin connections to the LPC2103 ==
{{{
!!! NOT UPDATED

Scale LCD input
Pin nr | LPC2103 pin
---------------------
 1  | P0.0
 2  | P0.1
 3  | P0.2
 4  | P0.3
 5  | P0.8
 6  | P0.9
 7  | P0.10
 8  | P0.11
 9  | P0.12
10  | P0.13
11  | P0.14
12  | P0.15
13  | P0.16 (EINT0 - external interrupt used. This is a signal from backplane 1)

LCD module output
 * -LCD ------------------------|-connected to-----
 *  1  - GND                    | GND
 *  2  - Vcc                     | Vcc ~= + 5 volts
 *  3  - Contrast               | 0,91V
 *  4  - _RS                      | P0.3
 *  5  - _R/W                   | P0.2
 *  6  - E                         | P0.17
 *  11 - DB4                    | P0.18
 *  12 - DB5                    | P0.21
 *  13 - DB6                    | P0.22
 *  14 - DB7                    | P0.23

SD Card
P0.4 SCK  SPI bus
P0.5 MISO SPI bus
P0.6 MOSI SPI bus
P0.7 SSEL SPI bus
}}}

== Fat file system drivers ==

I use [http://elm-chan.org/fsw/ff/00index_e.html FatFs] file system drivers which have a Free Software license. 